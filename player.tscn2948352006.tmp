[gd_scene load_steps=20 format=3 uid="uid://ybl0qgtjjtv7"]

[ext_resource type="Script" uid="uid://dsq18iuv8k63a" path="res://player.gd" id="1_u1c27"]
[ext_resource type="Texture2D" uid="uid://ca1c3j07jybu4" path="res://art/player/Adventurer/Idle/AdventurerIdle.png" id="2_2hs0m"]
[ext_resource type="Texture2D" uid="uid://dvhhja3j80nt3" path="res://art/player/Adventurer/Jab/AdventurerJab2.png" id="3_2hs0m"]
[ext_resource type="Texture2D" uid="uid://cgmtv0sp8rayn" path="res://art/player/Adventurer/Jab/AdventurerJab3.png" id="4_1jxqw"]
[ext_resource type="Texture2D" uid="uid://dluff2fwgb53g" path="res://art/player/Adventurer/Jab/AdventurerJab4.png" id="5_dw050"]
[ext_resource type="Texture2D" uid="uid://dnju2w8aic165" path="res://art/player/Adventurer/Jab/AdventurerJab5.png" id="6_b26j0"]
[ext_resource type="Script" uid="uid://bvvkmh6ewkfpx" path="res://PlayerStateMachine.gd" id="7_1jxqw"]
[ext_resource type="Texture2D" uid="uid://sv1tf1dqci2n" path="res://art/player/Adventurer/Walk/AdventurerWalk0.png" id="7_606se"]
[ext_resource type="Script" uid="uid://dxkei1l26m0tu" path="res://PlayerIdle.gd" id="8_dw050"]
[ext_resource type="Texture2D" uid="uid://ccymivk1uoesm" path="res://art/player/Adventurer/Walk/AdventurerWalk1.png" id="8_u1c27"]
[ext_resource type="Script" uid="uid://f56q02hivqub" path="res://PlayerJump.gd" id="9_b26j0"]
[ext_resource type="Script" uid="uid://bxnw4qeweflh8" path="res://PlayerWalk.gd" id="9_nvl01"]
[ext_resource type="Texture2D" uid="uid://dh6wvuctrp485" path="res://art/player/Adventurer/Walk/AdventurerWalk2.png" id="9_op7ga"]
[ext_resource type="Script" uid="uid://dp1fe6jmke2op" path="res://PlayerFall.gd" id="10_n7ghd"]
[ext_resource type="Texture2D" uid="uid://cuwwrvb1icyvy" path="res://art/player/Adventurer/Walk/AdventurerWalk3.png" id="10_q13i1"]
[ext_resource type="Script" uid="uid://c8xojrdxgkup5" path="res://PlayerWallCling.gd" id="16_u1c27"]
[ext_resource type="Script" uid="uid://bdy7yhdduaali" path="res://PlayerLaunched.gd" id="17_op7ga"]

[sub_resource type="SpriteFrames" id="SpriteFrames_onrkg"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("2_2hs0m")
}],
"loop": true,
"name": &"AdventurerIdle",
"speed": 60.0
}, {
"frames": [{
"duration": 5.0,
"texture": ExtResource("3_2hs0m")
}, {
"duration": 5.0,
"texture": ExtResource("4_1jxqw")
}, {
"duration": 5.0,
"texture": ExtResource("5_dw050")
}, {
"duration": 5.0,
"texture": ExtResource("6_b26j0")
}],
"loop": false,
"name": &"AdventurerJab",
"speed": 60.0
}, {
"frames": [{
"duration": 5.0,
"texture": ExtResource("7_606se")
}, {
"duration": 5.0,
"texture": ExtResource("8_u1c27")
}, {
"duration": 5.0,
"texture": ExtResource("9_op7ga")
}, {
"duration": 5.0,
"texture": ExtResource("10_q13i1")
}],
"loop": true,
"name": &"AdventurerWalk",
"speed": 60.0
}]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_i3pqv"]
size = Vector2(14, 26)

[node name="Player" type="CharacterBody2D" node_paths=PackedStringArray("animations", "statemach", "wall_cling_timer")]
scale = Vector2(2, 2)
floor_constant_speed = true
script = ExtResource("1_u1c27")
animations = NodePath("animations")
move_speed = 500.0
statemach = NodePath("StateMachine")
wall_cling_timer = NodePath("CanWallClingTimer")

[node name="animations" type="AnimatedSprite2D" parent="."]
visibility_layer = 16
position = Vector2(0, -16)
sprite_frames = SubResource("SpriteFrames_onrkg")
animation = &"AdventurerJab"
frame = 3
frame_progress = 1.0

[node name="CollisionBox" type="CollisionShape2D" parent="." groups=["Player Hurtbox"]]
position = Vector2(-5, -13)
shape = SubResource("RectangleShape2D_i3pqv")

[node name="invincibility" type="Timer" parent="CollisionBox"]

[node name="CanWallClingTimer" type="Timer" parent="."]
process_callback = 0
wait_time = 0.05
one_shot = true

[node name="WallSlideTimer" type="Timer" parent="."]
process_callback = 0
wait_time = 0.12
one_shot = true

[node name="DashTimer" type="Timer" parent="."]
process_callback = 0
one_shot = true

[node name="LaunchStunTimer" type="Timer" parent="."]
one_shot = true

[node name="Raycast" type="Node2D" parent="."]

[node name="LedgeR" type="RayCast2D" parent="Raycast"]
position = Vector2(-5, -15)
target_position = Vector2(30, 0)

[node name="GroundR" type="RayCast2D" parent="Raycast"]
position = Vector2(-5, 0)
target_position = Vector2(30, 0)

[node name="LedgeL" type="RayCast2D" parent="Raycast"]
position = Vector2(-5, -15)
target_position = Vector2(-30, 0)

[node name="GroundL" type="RayCast2D" parent="Raycast"]
position = Vector2(-5, 0)
target_position = Vector2(-30, 0)

[node name="StateMachine" type="Node" parent="." node_paths=PackedStringArray("initState", "parent")]
script = ExtResource("7_1jxqw")
initState = NodePath("Idle")
parent = NodePath("..")

[node name="Idle" type="Node" parent="StateMachine" node_paths=PackedStringArray("parent", "canTransitionTo")]
script = ExtResource("8_dw050")
animation_name = "AdventurerIdle"
parent = NodePath("..")
canTransitionTo = [NodePath("../Jump"), NodePath("../Fall"), NodePath("../Walk"), NodePath("../Launched")]

[node name="Walk" type="Node" parent="StateMachine" node_paths=PackedStringArray("parent", "canTransitionTo")]
script = ExtResource("9_nvl01")
animation_name = "AdventurerWalk"
parent = NodePath("..")
canTransitionTo = [NodePath("../Jump"), NodePath("../Fall"), NodePath("../Idle")]

[node name="Jump" type="Node" parent="StateMachine" node_paths=PackedStringArray("timer", "parent", "canTransitionTo")]
script = ExtResource("9_b26j0")
timer = NodePath("../../CanWallClingTimer")
animation_name = "AdventurerIdle"
parent = NodePath("..")
canTransitionTo = [NodePath("../Fall"), NodePath("../WallCling"), NodePath("../Launched")]

[node name="Fall" type="Node" parent="StateMachine" node_paths=PackedStringArray("parent", "canTransitionTo")]
script = ExtResource("10_n7ghd")
animation_name = "AdventurerIdle"
parent = NodePath("..")
canTransitionTo = [NodePath("../Idle"), NodePath("../WallCling"), NodePath("../Jump")]

[node name="LedgeGrab" type="Node" parent="StateMachine"]

[node name="WallCling" type="Node" parent="StateMachine" node_paths=PackedStringArray("timer", "parent", "canTransitionTo")]
script = ExtResource("16_u1c27")
timer = NodePath("../../WallSlideTimer")
animation_name = "AdventurerIdle"
parent = NodePath("..")
canTransitionTo = [NodePath("../Fall"), NodePath("../Jump")]

[node name="Launched" type="Node" parent="StateMachine" node_paths=PackedStringArray("timer", "parent", "canTransitionTo")]
script = ExtResource("17_op7ga")
launch = Vector2(500, -1000)
timer = NodePath("../../LaunchStunTimer")
animation_name = "AdventurerIdle"
parent = NodePath("..")
canTransitionTo = [NodePath("../Fall")]

[node name="Freefall" type="Node" parent="StateMachine"]

[node name="Jab" type="Node" parent="StateMachine"]

[node name="Filt" type="Node" parent="StateMachine"]

[node name="Dilt" type="Node" parent="StateMachine"]

[node name="Uilt" type="Node" parent="StateMachine"]

[node name="Nair" type="Node" parent="StateMachine"]

[node name="Fair" type="Node" parent="StateMachine"]

[node name="Dair" type="Node" parent="StateMachine"]

[node name="Uair" type="Node" parent="StateMachine"]

[node name="Bair" type="Node" parent="StateMachine"]

[node name="Fmash" type="Node" parent="StateMachine"]

[node name="Umash" type="Node" parent="StateMachine"]

[node name="Dmash" type="Node" parent="StateMachine"]

[node name="Special" type="Node" parent="StateMachine"]

[node name="Uustom" type="Node" parent="StateMachine"]

[node name="Dustum" type="Node" parent="StateMachine"]

[node name="Ultimate" type="Node" parent="StateMachine"]

[connection signal="timeout" from="CanWallClingTimer" to="StateMachine/Jump" method="wall_cling_timer"]
[connection signal="timeout" from="WallSlideTimer" to="StateMachine/WallCling" method="slip_timer"]
[connection signal="timeout" from="DashTimer" to="." method="_on_dash_timer_timeout"]
[connection signal="timeout" from="LaunchStunTimer" to="StateMachine/Launched" method="_timer_timeout"]
